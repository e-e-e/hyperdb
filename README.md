Just @mafintosh's branch where he is re-impl'ing everything
